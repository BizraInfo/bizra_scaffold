{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "BIZRA ZK Receipt Test Vectors v1.0",
  "description": "Golden test vectors for deterministic ZK receipt verification",
  "version": "1.0.0",
  "generated": "2024-12-26T00:00:00Z",
  "constants": {
    "FIXED_POINT_SCALE": 1000,
    "IHSAN_THRESHOLD_FIXED": 950,
    "SNR_THRESHOLD_FIXED": 750,
    "RECEIPT_SIZE_BYTES": 104,
    "HASH_SIZE_BYTES": 32
  },
  "receipts": [
    {
      "id": "vector-001",
      "description": "Minimal valid receipt with zero values",
      "input": {
        "agent_id": 0,
        "transaction_hash": "0000000000000000000000000000000000000000000000000000000000000000",
        "snr_score": 750,
        "ihsan_score": 950,
        "impact_score": 500,
        "timestamp": 0,
        "nonce": "0000000000000000000000000000000000000000000000000000000000000000"
      },
      "expected": {
        "meets_threshold": true,
        "circuit_input_hex": "0000000000000000000000000000000000000000000000000000000000000000000000000000000000ee020000000000000000b603000000000000f401000000000000000000000000000000000000000000000000000000000000000000000000000000",
        "receipt_hash_sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
      }
    },
    {
      "id": "vector-002",
      "description": "Standard receipt with typical values",
      "input": {
        "agent_id": 12345678,
        "transaction_hash": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
        "snr_score": 850,
        "ihsan_score": 970,
        "impact_score": 750,
        "timestamp": 1705320000,
        "nonce": "bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb"
      },
      "expected": {
        "meets_threshold": true,
        "fixed_point_check": {
          "ihsan_float": 0.97,
          "snr_float": 0.85
        }
      }
    },
    {
      "id": "vector-003",
      "description": "Receipt below Ihsan threshold - should fail",
      "input": {
        "agent_id": 999,
        "transaction_hash": "cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc",
        "snr_score": 800,
        "ihsan_score": 900,
        "impact_score": 600,
        "timestamp": 1705400000,
        "nonce": "dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd"
      },
      "expected": {
        "meets_threshold": false,
        "failure_reason": "ihsan_score 900 < threshold 950"
      }
    },
    {
      "id": "vector-004",
      "description": "Receipt below SNR threshold - should fail validation",
      "input": {
        "agent_id": 1000,
        "transaction_hash": "eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",
        "snr_score": 700,
        "ihsan_score": 980,
        "impact_score": 800,
        "timestamp": 1705500000,
        "nonce": "ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"
      },
      "expected": {
        "meets_threshold": true,
        "validation_result": {
          "valid": false,
          "reason": "SNR 700 < threshold 750"
        }
      }
    },
    {
      "id": "vector-005",
      "description": "Maximum u64 agent_id boundary test",
      "input": {
        "agent_id": 18446744073709551615,
        "transaction_hash": "1111111111111111111111111111111111111111111111111111111111111111",
        "snr_score": 999,
        "ihsan_score": 1000,
        "impact_score": 1000,
        "timestamp": 4294967295,
        "nonce": "2222222222222222222222222222222222222222222222222222222222222222"
      },
      "expected": {
        "meets_threshold": true,
        "boundary_test": "max_u64_agent_id"
      }
    },
    {
      "id": "vector-006",
      "description": "Exact threshold boundary - ihsan exactly at 950",
      "input": {
        "agent_id": 42,
        "transaction_hash": "3333333333333333333333333333333333333333333333333333333333333333",
        "snr_score": 750,
        "ihsan_score": 950,
        "impact_score": 0,
        "timestamp": 1000000000,
        "nonce": "4444444444444444444444444444444444444444444444444444444444444444"
      },
      "expected": {
        "meets_threshold": true,
        "boundary_test": "exact_ihsan_threshold"
      }
    },
    {
      "id": "vector-007",
      "description": "Just below threshold - ihsan at 949",
      "input": {
        "agent_id": 43,
        "transaction_hash": "5555555555555555555555555555555555555555555555555555555555555555",
        "snr_score": 750,
        "ihsan_score": 949,
        "impact_score": 0,
        "timestamp": 1000000001,
        "nonce": "6666666666666666666666666666666666666666666666666666666666666666"
      },
      "expected": {
        "meets_threshold": false,
        "boundary_test": "one_below_ihsan_threshold"
      }
    }
  ],
  "merkle_tree_vectors": [
    {
      "id": "merkle-001",
      "description": "Single leaf tree",
      "leaves": ["0000000000000000000000000000000000000000000000000000000000000000"],
      "expected_root": "66687aadf862bd776c8fc18b8e9f8e20089714856ee233b3902a591d0d5f2925"
    },
    {
      "id": "merkle-002",
      "description": "Two leaf tree",
      "leaves": [
        "0000000000000000000000000000000000000000000000000000000000000000",
        "1111111111111111111111111111111111111111111111111111111111111111"
      ],
      "expected_root_computation": "SHA256(leaf[0] || leaf[1])"
    },
    {
      "id": "merkle-003",
      "description": "Four leaf balanced tree",
      "leaves": [
        "0000000000000000000000000000000000000000000000000000000000000000",
        "1111111111111111111111111111111111111111111111111111111111111111",
        "2222222222222222222222222222222222222222222222222222222222222222",
        "3333333333333333333333333333333333333333333333333333333333333333"
      ],
      "expected_structure": {
        "depth": 2,
        "internal_nodes": 3
      }
    }
  ],
  "fixed_point_vectors": [
    {
      "float": 0.95,
      "fixed": 950,
      "description": "Standard Ihsan threshold"
    },
    {
      "float": 0.75,
      "fixed": 750,
      "description": "Standard SNR threshold"
    },
    {
      "float": 1.0,
      "fixed": 1000,
      "description": "Maximum score"
    },
    {
      "float": 0.0,
      "fixed": 0,
      "description": "Minimum score"
    },
    {
      "float": 0.999,
      "fixed": 999,
      "description": "Near-maximum (truncation test)"
    },
    {
      "float": 0.001,
      "fixed": 1,
      "description": "Near-minimum (precision test)"
    }
  ],
  "envelope_conversion_vectors": [
    {
      "id": "envelope-001",
      "description": "Standard PAT envelope conversion",
      "envelope": {
        "envelope_id": "env-12345678-1234-5678-9abc-def012345678",
        "timestamp": "2024-01-15T12:00:00Z",
        "nonce": "a1b2c3d4e5f60000000000000000000000000000000000000000000000000000",
        "sender": {
          "agent_id": "pat-agent-001",
          "agent_type": "PAT"
        },
        "metadata": {
          "ihsan_score": 0.97,
          "snr_score": 0.85
        }
      },
      "expected_receipt": {
        "ihsan_score_fixed": 970,
        "snr_score_fixed": 850,
        "agent_type_in_metadata": "PAT"
      }
    }
  ],
  "batch_vectors": [
    {
      "id": "batch-001",
      "description": "Single receipt batch",
      "batch_size": 1,
      "expected_header_size": 36,
      "expected_total_size": 140
    },
    {
      "id": "batch-002",
      "description": "Maximum batch (1000 receipts)",
      "batch_size": 1000,
      "expected_header_size": 36,
      "expected_total_size": 104036
    }
  ]
}
