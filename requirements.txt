# ============================================================================
# BIZRA AEON OMEGA - Development Dependencies
# ============================================================================
# Pin ALL versions for reproducible builds (SOT compliance)
# Last Updated: 2025-12-27
# Python: 3.10+ (numpy pins vary by interpreter version)
#
# NOTE: This project uses FastAPI (ASGI/Starlette stack), NOT Flask.
# CORS is handled via fastapi.middleware.cors.CORSMiddleware (see core/engine/api.py)
#
# CUDA Note: For GPU support, install torch with:
#   pip install torch==2.7.1+cu118 --extra-index-url https://download.pytorch.org/whl/cu118
#
# ⚠️ NUMPY VERSION POLICY:
# - Development: numpy 2.x for latest features
# - Production (requirements-production.txt): numpy <2.0 for scipy 1.11.x compatibility
# - Developers MUST NOT use numpy 2.0-only APIs in production code paths
#
# ⚠️ VERSION PINNING POLICY (SOT Compliance):
# - ALL dependencies MUST use exact version pins (==) for reproducibility
# - Minimum version constraints (>=) are ONLY allowed when:
#   1. A transitive dependency requires a minimum version, AND
#   2. The minimum satisfies our security requirements
# - Such exceptions MUST be documented with the requiring package
# ============================================================================

# Core ML & Numerics (pinned for reproducible builds)
# Using CPU version for CI compatibility - see CUDA Note above for GPU
torch==2.7.1                # CVE-2025-3730 affects 2.6.0 only (disputed)
numpy==2.2.6; python_version < "3.11"
numpy==2.3.3; python_version >= "3.11"
networkx==3.3
cryptography==45.0.7
defusedxml==0.7.1           # B314 fix: Secure XML parsing (prevents XXE attacks)

# Web API (FastAPI/ASGI stack - no Flask required)
fastapi==0.127.0            # Async web framework (tested compatible)
uvicorn[standard]==0.40.0   # ASGI server with uvloop/httptools
pydantic-settings==2.7.1    # Settings management (mcp requires >=2.5.2, pinned to latest stable)

# Authentication
PyJWT==2.10.1               # JWT tokens (mcp requires >=2.10.1, pinned to latest stable)

# Metrics & Monitoring
prometheus_client==0.19.0   # Metrics exporter

# Database Drivers
neo4j==5.14.0               # Graph database

# Vector Search
faiss-cpu==1.10.0           # Similarity search (>=1.9 for numpy 2.x compat, pinned to latest)

# Cryptography
blake3==0.3.3               # Fast hashing
toml==0.10.2                # TOML parser for constitution.toml

# ──────────────────────────────────────────────────────────────────────────
# Security Fixes (direct dependencies with CVE patches)
# ──────────────────────────────────────────────────────────────────────────
filelock==3.20.1            # CVE-2025-68146: race condition in lock acquisition
urllib3==2.6.0              # CVE-2025-66418, CVE-2025-66471: request smuggling
python-multipart==0.0.21    # GHSA-59g5-xgcq-4qw3: DoS in form parsing (>=0.0.18 patched)
pycryptodome==3.21.0        # GHSA-j225-cvw7-qrx7: OAEP decryption side-channel (pinned to latest)
black==24.10.0              # GHSA-fj7x-q9j7-g6q6: directory traversal vulnerability (pinned to latest)

# ──────────────────────────────────────────────────────────────────────────
# Transitive Security Fixes (indirect deps - pinned via constraints)
# ──────────────────────────────────────────────────────────────────────────
# NOTE: These are pulled in by other packages. Pin here to force secure versions.
# For production, consider using a constraints.txt file instead.
fonttools==4.60.2           # CVE-2024-51652: XML parsing vulnerability (transitive via matplotlib)
keras==3.12.0               # CVE-2025-66318: arbitrary code execution (transitive via torch)
mcp==1.23.0                 # CVE-2025-65874: SSRF vulnerability (transitive via opentelemetry)
